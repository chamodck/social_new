<p class="text-center text-muted">Â© Copyright 2016 3pnacs</p>

<div ng-controller="MessageCtrl">
    

    <div ng-repeat="messageGroup in messageGroupsArray" >

        <div class="row chat-window " id="chat_window_1" ng-style="messageGroup.style" ng-click="focus( messageGroup._id )">
        <div class="col-xs-12 col-md-12">
            <div class="panel panel-default">
                <div class="panel-heading top-bar">
                    <div class="col-md-8 col-xs-8">
                        <h3 class="panel-title"><span class="fa fa-comment"></span>{{messageGroup.name}}</h3>
                    </div>
                    <div class="col-md-4 col-xs-4" style="text-align: right;">
                        <a ><span id="minim_chat_window" class="fa fa-minus icon_minim"></span></a>
                        <a ><span ng-click="removeMessageBox(messageGroup)" class="fa fa-close" data-id="chat_window_1"></span></a>
                    </div>
                </div>
                <div class="panel-body msg_container_base" ng-attr-id="{{ 'msg-container-base-' + messageGroup._id }}" >
                    <div ng-repeat="message in messageGroup.messages" >
                        <div class="row msg_container base_sent info " ng-if="message.from==currentUserID || message.from._id==currentUserID">
                            <div class="col-md-10 col-xs-10 ">
                                <div class="messages msg_sent">
                                    <p>{{message.text}}</p>
                                    <time datetime="2009-11-13T20:00">{{message.created_at}}</time>
                                </div>
                            </div>
                            <div class="col-md-2 col-xs-2 avatar">
                                <img src="http://www.bitrebels.com/wp-content/uploads/2011/02/Original-Facebook-Geek-Profile-Avatar-1.jpg" class=" img-responsive ">
                            </div>
                        </div>

                        <div class="row msg_container base_receive" ng-if="message.from!=currentUserID && message.from._id!=currentUserID">
                            <div class="col-md-2 col-xs-2 avatar">
                                <img src="http://www.bitrebels.com/wp-content/uploads/2011/02/Original-Facebook-Geek-Profile-Avatar-1.jpg" class=" img-responsive ">
                            </div>
                            <div class="col-md-10 col-xs-10">
                                <div class="messages msg_receive">
                                    <p>{{message.text}} </p>
                                    <time datetime="2009-11-13T20:00">{{message.created_at}}</time>
                                </div>
                            </div>
                        </div>
                    </div>
                    <span ng-attr-id="{{ 'typing-' + messageGroup._id }}" style="display: none;">

                    </span>
                </div>

                <div class="panel-footer">
                    <form ng-submit="addNewMessage(messageGroup._id)" >
                        <div class="input-group">
                                <input ng-attr-id="{{ 'text-input-' + messageGroup._id }}" ng-change="typing(messageGroup._id)" autocomplete='off' type="text" ng-model="messageText" class="form-control input-sm chat_input" placeholder="Write your message here..." />
                                <span class="input-group-btn">
                                <button type="submit" class="btn btn-primary btn-sm" ng-attr-id="{{ 'btn-send-' + messageGroup._id }}">Send</button>
                                </span>
                        </div>
                    </form>
                </div>

            </div>
        </div>
    </div>
    
    </div>
</div>

<script>
    $('body').show();
    $('.version').text(NProgress.version);
    NProgress.start();
    setTimeout(function() { NProgress.done(); $('.fade').removeClass('out'); }, 1000);

    $("#b-0").click(function() { NProgress.start(); });
    $("#b-40").click(function() { NProgress.set(0.4); });
    $("#b-inc").click(function() { NProgress.inc(); });
    $("#b-100").click(function() { NProgress.done(); });
</script>